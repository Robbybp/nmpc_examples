\documentclass{article}

\setcounter{secnumdepth}{0}
\setlength{\parindent}{0pt}

\newcommand{\RP}{\vspace{0.5cm}RP\vspace{0.2cm}\hrule\vspace{0.2cm}}

\title{Implementing data structures for dynamic optimization and examples}

\begin{document}
\maketitle

\section{Jan 24, 2022}

\RP
First thing I need to do is see exactly what KH is doing (and testing) in his
NMPC simulation, so I can recreate it.

To recreate KH's tests, it looks like I need to be able to get plant
and controller data at the end of any particular sample.
In what format should my NMPC routine return ``predicted controller data?''
Probably the same format that it returns plant data. But instead of updating
the controller data with the entire controller model, I should update
with only the first sample.

\medskip

There are differences between my and Kuan-Han's objective functions.
He has a different target for \texttt{Tall[*,Tj]}, and penalizes
\texttt{Tjinb}, which I do not.
I also penalize values at all time points, while he only penalizes
them at sample points.

\medskip

NMPC seems to be working with KH's CSTR. I still need to test that the values
resulting from the solves are reasonable.

\vspace{0.5cm}\hrule\vspace{0.2cm}

\textbf{Aside:} Every time I go about setting up an NMPC script, I am surprised
about how long it takes me. This by itself is motivation enough for an NMPC
toolkit.
What parts take the longest? -- The data management. A small part of which is
passing data back and forth between plant and controller.

\vspace{0.2cm}\hrule\vspace{0.5cm}

\section{Jan 21, 2022}

\RP
Have re-implemented a rolling-horizon simulation of KH's model,
and tested the same values he tests. This works fine. Next is NMPC.

\section{Jan 20, 2022}

\RP
Want to make an NMPC script for Kuan-Han's CSTR example that doesn't use
Caprese. Need to make sure I pass the same tests he has written.
What is Kuan-Han testing in the simulation and NMPC scripts?

NMPC tests:
\begin{itemize}
  \item Tests controller setup.
    \begin{itemize}
      \item  Tests initial conditions of plant
      \item  and all values in controller model
    \end{itemize}
  \item \texttt{test\_solve\_first\_control\_NLP}
    \begin{itemize}
      \item Tests values at time 2.0 in controller model
      \item Tests value of \texttt{Tjinb} at position two in the controller
        dataframe.
      \item Tests values of plant at time 2.0
      \item Tests values in plant dataframe at position two
    \end{itemize}
  \item \texttt{test\_run\_iterations}
    \begin{itemize}
      \item Same tests as above, but runs ten NMPC steps instead of one
    \end{itemize}
\end{itemize}
These tests seem very reasonable. But they do involve some Caprese-specific data
structures, like \texttt{plant\_df} and \texttt{nmpc.controller.mod}.
I should copy the functionality of the tests while scrapping the Caprese
objects, i.e. copy KH's model and re-implement his NMPC problem from scratch
with my own data structures.
Hopefully thsi is not too difficult\ldots

\end{document}
